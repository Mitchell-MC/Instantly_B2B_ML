=== RANDOMFOREST BINARY CLASSIFICATION: EMAIL OPENING PREDICTION ===
=== LOADING AND PREPROCESSING DATA FROM CSV ===
✅ Data loaded from CSV. Shape: (26598, 94)

📊 Binary target distribution:
  Not opened (0): 14,129 (53.1%)
  Opened (1): 12,469 (46.9%)

✅ Feature engineering complete. Final shape: (26598, 13)
📋 Features include: ['lt_interest_status', 'title', 'city', 'state', 'country', 'organization_industry', 'organization_employees', 'organization_founded_year', 'seniority', 'text_length']...

📊 Data split:
  Training set: (19948, 13)
  Test set: (6650, 13)

=== APPLYING ENHANCED PREPROCESSING ===
✅ Preprocessed data shape:
  Training: (19948, 13)
  Test: (6650, 13)
  Selected features: 13

🔍 Starting Grid Search CV for RandomForest Hyperparameter Optimization...
================================================================================

📊 Phase 1: Broad Grid Search
--------------------------------------------------
🔄 Fitting broad grid search...
Fitting 5 folds for each of 243 candidates, totalling 1215 fits
✅ Best broad score: 0.7552
📋 Best broad params: {'max_depth': 20, 'max_features': 'sqrt', 'min_samples_leaf': 1, 'min_samples_split': 2, 'n_estimators': 300}

🎯 Phase 2: Detailed Grid Search
--------------------------------------------------
🔄 Fitting detailed grid search...
Fitting 5 folds for each of 1296 candidates, totalling 6480 fits
✅ Best detailed score: 0.7566
📋 Best detailed params: {'bootstrap': False, 'criterion': 'gini', 'max_depth': 20, 'max_features': 'sqrt', 'min_samples_leaf': 2, 'min_samples_split': 2, 'n_estimators': 350}

🏆 OPTIMAL HYPERPARAMETERS FOUND:
==================================================
bootstrap           : False
criterion           : gini
max_depth           : 20
max_features        : sqrt
min_samples_leaf    : 2
min_samples_split   : 2
n_estimators        : 350

⭐ Optimal CV Score: 0.7566

=== MODEL EVALUATION ===

📊 Classification Report:
              precision    recall  f1-score   support

  Not Opened       0.71      0.73      0.72      3533
      Opened       0.68      0.66      0.67      3117

    accuracy                           0.70      6650
   macro avg       0.70      0.70      0.70      6650
weighted avg       0.70      0.70      0.70      6650

🎯 Accuracy: 0.6986
📈 ROC AUC: 0.7800

=== FEATURE IMPORTANCE ===

🔝 Top 10 most important features:
   1. text_length                   : 0.0000
   2. lt_interest_status            : 0.0001
   3. seniority                     : 0.0660
   4. country                       : 0.0749
   5. state                         : 0.1008
   6. city                          : 0.1242
   7. organization_industry         : 0.1367
   8. organization_founded_year     : 0.1405
   9. title                         : 0.1507
  10. organization_employees        : 0.2062

💾 Feature importance plot saved as 'randomforest_binary_feature_importance.png'
💾 Confusion matrix saved as 'randomforest_binary_confusion_matrix.png'

================================================================================
🎉 FINAL SUMMARY:
================================================================================
✅ Loaded data from merged CSV
✅ Binary classification: Opening vs Not Opening
✅ Two-phase grid search optimization completed
✅ Enhanced preprocessing with feature selection
✅ RandomForest with optimal hyperparameters

🎯 Test accuracy: 0.6986
📈 Test ROC AUC: 0.7800
📊 Training samples: 19,948
📊 Test samples: 6,650
🔧 Final features: 13
⚙️  Optimal parameters: 7 hyperparameters optimized
================================================================================